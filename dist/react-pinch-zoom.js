!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("react"),require("react-dom")):"function"==typeof define&&define.amd?define(["react","react-dom"],t):"object"==typeof exports?exports.ReactPinchZoom=t(require("react"),require("react-dom")):e.ReactPinchZoom=t(e.React,e.ReactDOM)}(this,function(e,t){return function(e){function t(i){if(n[i])return n[i].exports;var o=n[i]={exports:{},id:i,loaded:!1};return e[i].call(o.exports,o,o.exports,t),o.loaded=!0,o.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){"use strict";e.exports=n(1)["default"]},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function o(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function r(e,t){var n={};for(var i in e)t.indexOf(i)>=0||Object.prototype.hasOwnProperty.call(e,i)&&(n[i]=e[i]);return n}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==("undefined"==typeof t?"undefined":c(t))&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+("undefined"==typeof t?"undefined":c(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),p=n(2),d=i(p),m=n(3),f=i(m),h=n(4),v=(i(h),n(5)),y=(i(v),n(6)),x=i(y),g=n(7),b=i(g);n(8);var w="zvui-pinch",z=function(e){function t(){var e,n,i,o;a(this,t);for(var r=arguments.length,u=Array(r),c=0;c<r;c++)u[c]=arguments[c];return n=i=l(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(u))),C.call(i),o=n,l(i,o)}return u(t,e),s(t,[{key:"render",value:function(){var e=this.props,t=e.id,n=e.className;return n=(0,x["default"])([w,n]).trim(),d["default"].createElement("div",{id:t,className:n,tabIndex:"-1",role:"dialog"},d["default"].createElement("div",{className:w+"__bg"}),d["default"].createElement("div",{className:w+"__scroll-wrap"}),d["default"].createElement("div",{className:w+"__container"},d["default"].createElement("div",{className:w+"__item"}),d["default"].createElement("div",{className:w+"__item"}),d["default"].createElement("div",{className:w+"__item"})),d["default"].createElement("div",{className:w+"__ui "+w+"__ui--hidden"},d["default"].createElement("div",{className:w+"__top-bar"},d["default"].createElement("button",{className:w+"__button "+w+"__button--close",title:"Close (Esc)"}),d["default"].createElement("button",{className:w+"__button "+w+"__button--share",title:"Share"}),d["default"].createElement("button",{className:w+"__button "+w+"__button--fs",title:"Toggle fullscreen"}),d["default"].createElement("button",{className:w+"__button "+w+"__button--zoom",title:"Zoom in/out"}),d["default"].createElement("div",{className:w+"__preloader"},d["default"].createElement("div",{className:w+"__preloader__icn"},d["default"].createElement("div",{className:w+"__preloader__cut"},d["default"].createElement("div",{className:w+"__preloader__donut"})))))))}}]),t}(p.Component);z.propTypes={isOpen:p.PropTypes.bool.isRequired,items:p.PropTypes.array.isRequired,options:p.PropTypes.object,onClose:p.PropTypes.func,id:p.PropTypes.string,className:p.PropTypes.string},z.defaultProps={items:[],options:{}};var C=function(){var e=this;this.state={isOpen:!1},this.componentDidMount=function(){var t=e.state.isOpen;t&&e.openPhotoSwipe(e.props)},this.componentWillReceiveProps=function(t){var n=e.state.isOpen;t.isOpen?n?e.updateItems(t.items):e.openPhotoSwipe(t):n&&e.closePhotoSwipe()},this.componentWillUnmount=function(){e.closePhotoSwipe()},this.openPhotoSwipe=function(t){var n=t.items,i=t.options,a=(r(t,["items","options"]),f["default"].findDOMNode(e));e.photoSwipe=new Photoswipe(a,PhotoswipeUIDefault,n,i),b["default"].forEach(function(n){var i=t[n];(i||"destroy"===n)&&!function(){var t=e;e.photoSwipe.listen(n,function(){if(i){var e=1===arguments.length?[arguments[0]]:Array.apply(null,arguments);e.unshift(this),i.apply(void 0,o(e))}"destroy"===n&&t.handleClose()})}()}),e.setState({isOpen:!0},function(){e.photoSwipe.inti()})},this.updateItems=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];e.photoSwipe.items.length=0,t.forEach(function(t){e.photoSwipe.items.push(t)})},this.closePhotoSwipe=function(){e.photoSwipe&&e.photoSwipe.close()},this.handleClose=function(){var t=e.props.onClose;e.setState({isOpen:!1},function(){t&&t()})}};t["default"]=z},function(t,n){t.exports=e},function(e,n){e.exports=t},function(e,t,n){var i,o;"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(r,a){i=a,o="function"==typeof i?i.call(t,n,t,e):i,!(void 0!==o&&(e.exports=o))}(void 0,function(e,t,n){return function(e,t,n,i){var o=this,r=25,a=3,l={allowPanToNext:!0,spacing:.12,bgOpacity:1,mouseUsed:!1,loop:!0,pinchToClose:!0,closeOnScroll:!0,closeOnVerticalDrag:!0,verticalDragRange:.75,hideAnimationDuration:333,showAnimationDuration:333,showHideOpacity:!1,focus:!0,escKey:!0,arrowKeys:!0,mainScrollEndFriction:.35,panEndFriction:.35,isClickableElement:function(e){return"A"===e.tagName},getDoubleTapZoom:function(e,t){return e?1:t.initialZoomLevel<.7?1:1.33},maxSpreadZoom:1.33,modal:!0,scaleMode:"fit"};helper.extend(l,i);var u,c,s,p,d,m,f,h,v,y,x,g,b,w,z,C,I,T,_,S,E,P,D,O,M,k,F,A,R,Z,L,N,U,K,H,W,B,G,Y,q,j,X,V,J,Q,$,ee,te,ne,ie,oe,re,ae,le,ue,ce,se=function(){return{x:0,y:0}},pe=se(),de=se(),me=se(),fe={},he=0,ve={},ye=se(),xe=0,ge=!0,be=[],we={},ze=!1,Ce=function(e,t){helper.extend(o,t.publicMethods),be.push(e)},Ie=function(e){var t=Qt();return e>t-1?e-t:e<0?t+e:e},Te={},_e=function(e,t){return Te[e]||(Te[e]=[]),Te[e].push(t)},Se=function(e){var t=Te[e];if(t){var n=Array.prototype.slice.call(arguments);n.shift();for(var i=0;i<t.length;i++)t[i].apply(o,n)}},Ee=function(){return(new Date).getTime()},Pe=function(e){le=e,o.bg.style.opacity=e*l.bgOpacity},De=function(e,t,n,i,r){(!ze||r&&r!==o.currItem)&&(i/=r?r.fitRatio:o.currItem.fitRatio),e[P]=g+t+"px, "+n+"px"+b+" scale("+i+")"},Oe=function(e){ne&&(e&&(y>o.currItem.fitRatio?ze||(pn(o.currItem,!1,!0),ze=!0):ze&&(pn(o.currItem),ze=!1)),De(ne,me.x,me.y,y))},Me=function(e){e.container&&De(e.container.style,e.initialPosition.x,e.initialPosition.y,e.initialZoomLevel,e)},ke=function(e,t){t[P]=g+e+"px, 0px"+b},Fe=function(e,t){if(!l.loop&&t){var n=p+(ye.x*he-e)/ye.x,i=Math.round(e-yt.x);(n<0&&i>0||n>=Qt()-1&&i<0)&&(e=yt.x+i*l.mainScrollEndFriction)}yt.x=e,ke(e,d)},Ae=function(e,t){var n=xt[e]-ve[e];return de[e]+pe[e]+n-n*(t/x)},Re=function(e,t){e.x=t.x,e.y=t.y,t.id&&(e.id=t.id)},Ze=function(e){e.x=Math.round(e.x),e.y=Math.round(e.y)},Le=null,Ne=function Fn(){Le&&(helper.unbind(document,"mousemove",Fn),helper.addClass(e,"zvui-pinch--has_mouse"),l.mouseUsed=!0,Se("mouseUsed")),Le=setTimeout(function(){Le=null},100)},Ue=function(){helper.bind(document,"keydown",o),L.transform&&helper.bind(o.scrollWrap,"click",o),l.mouseUsed||helper.bind(document,"mousemove",Ne),helper.bind(window,"resize scroll",o),Se("bindEvents")},Ke=function(){helper.unbind(window,"resize",o),helper.unbind(window,"scroll",v.scroll),helper.unbind(document,"keydown",o),helper.unbind(document,"mousemove",Ne),L.transform&&helper.unbind(o.scrollWrap,"click",o),G&&helper.unbind(window,f,o),Se("unbindEvents")},He=function(e,t){var n=ln(o.currItem,fe,e);return t&&(te=n),n},We=function(e){return e||(e=o.currItem),e.initialZoomLevel},Be=function(e){return e||(e=o.currItem),e.w>0?l.maxSpreadZoom:1},Ge=function(e,t,n,i){return i===o.currItem.initialZoomLevel?(n[e]=o.currItem.initialPosition[e],!0):(n[e]=Ae(e,i),n[e]>t.min[e]?(n[e]=t.min[e],!0):n[e]<t.max[e]&&(n[e]=t.max[e],!0))},Ye=function(){if(P){var t=L.perspective&&!O;return g="translate"+(t?"3d(":"("),void(b=L.perspective?", 0px)":")")}P="left",helper.addClass(e,"zvui-pinch--ie"),ke=function(e,t){t.left=e+"px"},Me=function(e){var t=e.fitRatio>1?1:e.fitRatio,n=e.container.style,i=t*e.w,o=t*e.h;n.width=i+"px",n.height=o+"px",n.left=e.initialPosition.x+"px",n.top=e.initialPosition.y+"px"},Oe=function(){if(ne){var e=ne,t=o.currItem,n=t.fitRatio>1?1:t.fitRatio,i=n*t.w,r=n*t.h;e.width=i+"px",e.height=r+"px",e.left=me.x+"px",e.top=me.y+"px"}}},qe=function(e){var t="";l.escKey&&27===e.keyCode?t="close":l.arrowKeys&&(37===e.keyCode?t="prev":39===e.keyCode&&(t="next")),t&&(e.ctrlKey||e.altKey||e.shiftKey||e.metaKey||(e.preventDefault?e.preventDefault():e.returnValue=!1,o[t]()))},je=function(e){e&&(j||q||ie||W)&&(e.preventDefault(),e.stopPropagation())},Xe=function(){o.setScrollOffset(0,helper.getScrollY())},Ve={},Je=0,Qe=function(e){Ve[e]&&(Ve[e].raf&&k(Ve[e].raf),Je--,delete Ve[e])},$e=function(e){Ve[e]&&Qe(e),Ve[e]||(Je++,Ve[e]={})},et=function(){for(var e in Ve)Ve.hasOwnProperty(e)&&Qe(e)},tt=function(e,t,n,i,o,r,a){var l,u=Ee();$e(e);var c=function s(){if(Ve[e]){if(l=Ee()-u,l>=i)return Qe(e),r(n),void(a&&a());r((n-t)*o(l/i)+t),Ve[e].raf=M(s)}};c()},nt={shout:Se,listen:_e,viewportSize:fe,options:l,isMainScrollAnimating:function(){return ie},getZoomLevel:function(){return y},getCurrentIndex:function(){return p},isDragging:function(){return G},isZooming:function(){return Q},setScrollOffset:function(e,t){ve.x=e,Z=ve.y=t,Se("updateScrollOffset",ve)},applyZoomPan:function(e,t,n,i){me.x=t,me.y=n,y=e,Oe(i)},init:function(){if(!u&&!c){var n;o.helper=helper,o.template=e,o.bg=helper.getChildByClass(e,"zvui-pinch__bg"),F=e.className,u=!0,L=helper.detectFeatures(),M=L.raf,k=L.caf,P=L.transform,R=L.oldIE,o.scrollWrap=helper.getChildByClass(e,"zvui-pinch__scroll-wrap"),o.container=helper.getChildByClass(o.scrollWrap,"zvui-pinch__container"),d=o.container.style,o.itemHolders=C=[{el:o.container.children[0],wrap:0,index:-1},{el:o.container.children[1],wrap:0,index:-1},{el:o.container.children[2],wrap:0,index:-1}],C[0].el.style.display=C[2].el.style.display="none",Ye(),v={resize:o.updateSize,scroll:Xe,keydown:qe,click:je};var i=L.isOldIOSPhone||L.isOldAndroid||L.isMobileOpera;for(L.animationName&&L.transform&&!i||(l.showAnimationDuration=l.hideAnimationDuration=0),n=0;n<be.length;n++)o["init"+be[n]]();if(t){var r=o.ui=new t(o,helper);r.init()}Se("firstUpdate"),p=p||l.index||0,(isNaN(p)||p<0||p>=Qt())&&(p=0),o.currItem=Jt(p),(L.isOldIOSPhone||L.isOldAndroid)&&(ge=!1),e.setAttribute("aria-hidden","false"),l.modal&&(ge?e.style.position="fixed":(e.style.position="absolute",e.style.top=helper.getScrollY()+"px")),void 0===Z&&(Se("initialLayout"),Z=A=helper.getScrollY());var s="zvui-pinch--open ";for(l.mainClass&&(s+=l.mainClass+" "),l.showHideOpacity&&(s+="zvui-pinch--animate_opacity "),s+=O?"zvui-pinch--touch":"zvui-pinch--notouch",s+=L.animationName?" zvui-pinch--css_animation":"",s+=L.svg?" zvui-pinch--svg":"",helper.addClass(e,s),o.updateSize(),m=-1,xe=null,n=0;n<a;n++)ke((n+m)*ye.x,C[n].el.style);R||helper.bind(o.scrollWrap,h,o),_e("initialZoomInEnd",function(){o.setContent(C[0],p-1),o.setContent(C[2],p+1),C[0].el.style.display=C[2].el.style.display="block",l.focus&&e.focus(),Ue()}),o.setContent(C[1],p),o.updateCurrItem(),Se("afterInit"),ge||(w=setInterval(function(){Je||G||Q||y!==o.currItem.initialZoomLevel||o.updateSize()},1e3)),helper.addClass(e,"zvui-pinch--visible")}},close:function(){u&&(u=!1,c=!0,Se("close"),Ke(),en(o.currItem,null,!0,o.destroy))},destroy:function(){Se("destroy"),qt&&clearTimeout(qt),e.setAttribute("aria-hidden","true"),e.className=F,w&&clearInterval(w),helper.unbind(o.scrollWrap,h,o),helper.unbind(window,"scroll",o),Ct(),et(),Te=null},panTo:function(e,t,n){n||(e>te.min.x?e=te.min.x:e<te.max.x&&(e=te.max.x),t>te.min.y?t=te.min.y:t<te.max.y&&(t=te.max.y)),me.x=e,me.y=t,Oe()},handleEvent:function(e){e=e||window.event,v[e.type]&&v[e.type](e)},goTo:function(e){e=Ie(e);var t=e-p;xe=t,p=e,o.currItem=Jt(p),he-=t,Fe(ye.x*he),et(),ie=!1,o.updateCurrItem()},next:function(){o.goTo(p+1)},prev:function(){o.goTo(p-1)},updateCurrZoomItem:function(e){if(e&&Se("beforeChange",0),C[1].el.children.length){var t=C[1].el.children[0];ne=helper.hasClass(t,"zvui-pinch__zoom-wrap")?t.style:null}else ne=null;te=o.currItem.bounds,x=y=o.currItem.initialZoomLevel,me.x=te.center.x,me.y=te.center.y,e&&Se("afterChange")},invalidateCurrItems:function(){z=!0;for(var e=0;e<a;e++)C[e].item&&(C[e].item.needsUpdate=!0)},updateCurrItem:function(e){if(0!==xe){var t,n=Math.abs(xe);if(!(e&&n<2)){o.currItem=Jt(p),ze=!1,Se("beforeChange",xe),n>=a&&(m+=xe+(xe>0?-a:a),n=a);for(var i=0;i<n;i++)xe>0?(t=C.shift(),C[a-1]=t,m++,ke((m+2)*ye.x,t.el.style),o.setContent(t,p-n+i+1+1)):(t=C.pop(),C.unshift(t),m--,ke(m*ye.x,t.el.style),o.setContent(t,p+n-i-1-1));if(ne&&1===Math.abs(xe)){var r=Jt(I);r.initialZoomLevel!==y&&(ln(r,fe),pn(r),Me(r))}xe=0,o.updateCurrZoomItem(),I=p,Se("afterChange")}}},updateSize:function(t){if(!ge&&l.modal){var n=helper.getScrollY();if(Z!==n&&(e.style.top=n+"px",Z=n),!t&&we.x===window.innerWidth&&we.y===window.innerHeight)return;we.x=window.innerWidth,we.y=window.innerHeight,e.style.height=we.y+"px"}if(fe.x=o.scrollWrap.clientWidth,fe.y=o.scrollWrap.clientHeight,Xe(),ye.x=fe.x+Math.round(fe.x*l.spacing),ye.y=fe.y,Fe(ye.x*he),Se("beforeResize"),void 0!==m){for(var i,r,u,c=0;c<a;c++)i=C[c],ke((c+m)*ye.x,i.el.style),u=p+c-1,l.loop&&Qt()>2&&(u=Ie(u)),r=Jt(u),r&&(z||r.needsUpdate||!r.bounds)?(o.cleanSlide(r),o.setContent(i,u),1===c&&(o.currItem=r,o.updateCurrZoomItem(!0)),r.needsUpdate=!1):i.index===-1&&u>=0&&o.setContent(i,u),r&&r.container&&(ln(r,fe),pn(r),Me(r));z=!1}x=y=o.currItem.initialZoomLevel,te=o.currItem.bounds,te&&(me.x=te.center.x,me.y=te.center.y,Oe(!0)),Se("resize")},zoomTo:function(e,t,n,i,o){t&&(x=y,xt.x=Math.abs(t.x)-me.x,xt.y=Math.abs(t.y)-me.y,Re(de,me));var r=He(e,!1),a={};Ge("x",r,a,e),Ge("y",r,a,e);var l=y,u={x:me.x,y:me.y};Ze(a);var c=function(t){1===t?(y=e,me.x=a.x,me.y=a.y):(y=(e-l)*t+l,me.x=(a.x-u.x)*t+u.x,me.y=(a.y-u.y)*t+u.y),o&&o(t),Oe(1===t)};n?tt("customZoomTo",0,1,n,i||helper.easing.sine.inOut,c):c(1)}},it=30,ot=10,rt={},at={},lt={},ut={},ct={},st=[],pt={},dt=[],mt={},ft=0,ht=se(),vt=0,yt=se(),xt=se(),gt=se(),bt=function(e,t){return e.x===t.x&&e.y===t.y},wt=function(e,t){return Math.abs(e.x-t.x)<r&&Math.abs(e.y-t.y)<r},zt=function(e,t){return mt.x=Math.abs(e.x-t.x),mt.y=Math.abs(e.y-t.y),Math.sqrt(mt.x*mt.x+mt.y*mt.y)},Ct=function(){X&&(k(X),X=null)},It=function An(){G&&(X=M(An),Ut())},Tt=function(){return!("fit"===l.scaleMode&&y===o.currItem.initialZoomLevel)},_t=function Rn(e,t){return!(!e||e===document)&&(!(e.getAttribute("class")&&e.getAttribute("class").indexOf("zvui-pinch__scroll-wrap")>-1)&&(t(e)?e:Rn(e.parentNode,t)))},St={},Et=function(e,t){return St.prevent=!_t(e.target,l.isClickableElement),Se("preventDragEvent",e,t,St),St.prevent},Pt=function(e,t){return t.x=e.pageX,t.y=e.pageY,t.id=e.identifier,t},Dt=function(e,t,n){n.x=.5*(e.x+t.x),n.y=.5*(e.y+t.y)},Ot=function(e,t,n){if(e-U>50){var i=dt.length>2?dt.shift():{};i.x=t,i.y=n,dt.push(i),U=e}},Mt=function(){var e=me.y-o.currItem.initialPosition.y;return 1-Math.abs(e/(fe.y/2))},kt={},Ft={},At=[],Rt=function(e){for(;At.length>0;)At.pop();return D?(ce=0,st.forEach(function(e){0===ce?At[0]=e:1===ce&&(At[1]=e),ce++})):e.type.indexOf("touch")>-1?e.touches&&e.touches.length>0&&(At[0]=Pt(e.touches[0],kt),e.touches.length>1&&(At[1]=Pt(e.touches[1],Ft))):(kt.x=e.pageX,kt.y=e.pageY,kt.id="",At[0]=kt),At},Zt=function(e,t){var n,i,r,a,u=0,c=me[e]+t[e],s=t[e]>0,p=yt.x+t.x,d=yt.x-pt.x;return n=c>te.min[e]||c<te.max[e]?l.panEndFriction:1,c=me[e]+t[e]*n,!l.allowPanToNext&&y!==o.currItem.initialZoomLevel||(ne?"h"!==oe||"x"!==e||q||(s?(c>te.min[e]&&(n=l.panEndFriction,u=te.min[e]-c,i=te.min[e]-de[e]),(i<=0||d<0)&&Qt()>1?(a=p,d<0&&p>pt.x&&(a=pt.x)):te.min.x!==te.max.x&&(r=c)):(c<te.max[e]&&(n=l.panEndFriction,u=c-te.max[e],i=de[e]-te.max[e]),(i<=0||d>0)&&Qt()>1?(a=p,d>0&&p<pt.x&&(a=pt.x)):te.min.x!==te.max.x&&(r=c))):a=p,"x"!==e)?void(ie||V||y>o.currItem.fitRatio&&(me[e]+=t[e]*n)):(void 0!==a&&(Fe(a,!0),V=a!==pt.x),te.min.x!==te.max.x&&(void 0!==r?me.x=r:V||(me.x+=t.x*n)),void 0!==a)},Lt=function(e){if(!("mousedown"===e.type&&e.button>0)){if(Vt)return void e.preventDefault();if(!B||"mousedown"!==e.type){if(Et(e,!0)&&e.preventDefault(),Se("pointerDown"),D){var t=helper.arraySearch(st,e.pointerId,"id");t<0&&(t=st.length),st[t]={x:e.pageX,y:e.pageY,id:e.pointerId}}var n=Rt(e),i=n.length;J=null,et(),G&&1!==i||(G=re=!0,helper.bind(window,f,o),H=ue=ae=W=V=j=Y=q=!1,oe=null,Se("firstTouchStart",n),Re(de,me),pe.x=pe.y=0,Re(ut,n[0]),Re(ct,ut),pt.x=ye.x*he,dt=[{x:ut.x,y:ut.y}],U=N=Ee(),He(y,!0),Ct(),It()),!Q&&i>1&&!ie&&!V&&(x=y,q=!1,Q=Y=!0,pe.y=pe.x=0,Re(de,me),Re(rt,n[0]),Re(at,n[1]),Dt(rt,at,gt),xt.x=Math.abs(gt.x)-me.x,xt.y=Math.abs(gt.y)-me.y,$=ee=zt(rt,at))}}},Nt=function(e){if(e.preventDefault(),D){var t=helper.arraySearch(st,e.pointerId,"id");if(t>-1){var n=st[t];n.x=e.pageX,n.y=e.pageY}}if(G){var i=Rt(e);if(oe||j||Q)J=i;else if(yt.x!==ye.x*he)oe="h";else{var o=Math.abs(i[0].x-ut.x)-Math.abs(i[0].y-ut.y);Math.abs(o)>=ot&&(oe=o>0?"h":"v",J=i)}}},Ut=function(){if(J){var e=J.length;if(0!==e)if(Re(rt,J[0]),lt.x=rt.x-ut.x,lt.y=rt.y-ut.y,Q&&e>1){if(ut.x=rt.x,ut.y=rt.y,!lt.x&&!lt.y&&bt(J[1],at))return;Re(at,J[1]),q||(q=!0,Se("zoomGestureStarted"));var t=zt(rt,at),n=Gt(t);n>o.currItem.initialZoomLevel+o.currItem.initialZoomLevel/15&&(ue=!0);var i=1,r=We(),a=Be();if(n<r)if(l.pinchToClose&&!ue&&x<=o.currItem.initialZoomLevel){var u=r-n,c=1-u/(r/1.2);Pe(c),Se("onPinchClose",c),ae=!0}else i=(r-n)/r,i>1&&(i=1),n=r-i*(r/3);else n>a&&(i=(n-a)/(6*r),i>1&&(i=1),n=a+i*r);i<0&&(i=0),$=t,Dt(rt,at,ht),pe.x+=ht.x-gt.x,pe.y+=ht.y-gt.y,Re(gt,ht),me.x=Ae("x",n),me.y=Ae("y",n),H=n>y,y=n,Oe()}else{if(!oe)return;if(re&&(re=!1,Math.abs(lt.x)>=ot&&(lt.x-=J[0].x-ct.x),Math.abs(lt.y)>=ot&&(lt.y-=J[0].y-ct.y)),ut.x=rt.x,ut.y=rt.y,0===lt.x&&0===lt.y)return;if("v"===oe&&l.closeOnVerticalDrag&&!Tt()){pe.y+=lt.y,me.y+=lt.y;var s=Mt();return W=!0,Se("onVerticalDrag",s),Pe(s),void Oe()}Ot(Ee(),rt.x,rt.y),j=!0,te=o.currItem.bounds;var p=Zt("x",lt);p||(Zt("y",lt),Ze(me),Oe())}}},Kt=function(e){if(L.isOldAndroid){if(B&&"mouseup"===e.type)return;e.type.indexOf("touch")>-1&&(clearTimeout(B),B=setTimeout(function(){B=0},600))}Se("pointerUp"),Et(e,!1)&&e.preventDefault();var t;if(D){var n=helper.arraySearch(st,e.pointerId,"id");if(n>-1)if(t=st.splice(n,1)[0],navigator.pointerEnabled)t.type=e.pointerType||"mouse";else{var i={4:"mouse",2:"touch",3:"pen"};t.type=i[e.pointerType],t.type||(t.type=e.pointerType||"mouse")}}var r,a=Rt(e),u=a.length;if("mouseup"===e.type&&(u=0),2===u)return J=null,!0;1===u&&Re(ct,a[0]),0!==u||oe||ie||(t||("mouseup"===e.type?t={x:e.pageX,y:e.pageY,type:"mouse"}:e.changedTouches&&e.changedTouches[0]&&(t={x:e.changedTouches[0].pageX,y:e.changedTouches[0].pageY,type:"touch"})),Se("touchRelease",e,t));var c=-1;if(0===u&&(G=!1,helper.unbind(window,f,o),Ct(),Q?c=0:vt!==-1&&(c=Ee()-vt)),vt=1===u?Ee():-1,r=c!==-1&&c<150?"zoom":"swipe",Q&&u<2&&(Q=!1,1===u&&(r="zoomPointerUp"),Se("zoomGestureEnded")),J=null,j||q||ie||W)if(et(),K||(K=Ht()),K.calculateSwipeSpeed("x"),W){var s=Mt();if(s<l.verticalDragRange)o.close();else{var p=me.y,d=le;tt("verticalDrag",0,1,300,helper.easing.cubic.out,function(e){me.y=(o.currItem.initialPosition.y-p)*e+p,Pe((1-d)*e+d),Oe()}),Se("onVerticalDrag",1)}}else{if((V||ie)&&0===u){var m=Bt(r,K);if(m)return;r="zoomPointerUp"}if(!ie)return"swipe"!==r?void Yt():void(!V&&y>o.currItem.fitRatio&&Wt(K))}},Ht=function(){var e,t,n={lastFlickOffset:{},lastFlickDist:{},lastFlickSpeed:{},slowDownRatio:{},slowDownRatioReverse:{},speedDecelerationRatio:{},speedDecelerationRatioAbs:{},distanceOffset:{},backAnimDestination:{},backAnimStarted:{},calculateSwipeSpeed:function(i){dt.length>1?(e=Ee()-U+50,t=dt[dt.length-2][i]):(e=Ee()-N,t=ct[i]),n.lastFlickOffset[i]=ut[i]-t,n.lastFlickDist[i]=Math.abs(n.lastFlickOffset[i]),n.lastFlickDist[i]>20?n.lastFlickSpeed[i]=n.lastFlickOffset[i]/e:n.lastFlickSpeed[i]=0,Math.abs(n.lastFlickSpeed[i])<.1&&(n.lastFlickSpeed[i]=0),n.slowDownRatio[i]=.95,n.slowDownRatioReverse[i]=1-n.slowDownRatio[i],n.speedDecelerationRatio[i]=1},calculateOverBoundsAnimOffset:function(e,t){n.backAnimStarted[e]||(me[e]>te.min[e]?n.backAnimDestination[e]=te.min[e]:me[e]<te.max[e]&&(n.backAnimDestination[e]=te.max[e]),void 0!==n.backAnimDestination[e]&&(n.slowDownRatio[e]=.7,n.slowDownRatioReverse[e]=1-n.slowDownRatio[e],n.speedDecelerationRatioAbs[e]<.05&&(n.lastFlickSpeed[e]=0,n.backAnimStarted[e]=!0,tt("bounceZoomPan"+e,me[e],n.backAnimDestination[e],t||300,helper.easing.sine.out,function(t){me[e]=t,Oe()}))))},calculateAnimOffset:function(e){n.backAnimStarted[e]||(n.speedDecelerationRatio[e]=n.speedDecelerationRatio[e]*(n.slowDownRatio[e]+n.slowDownRatioReverse[e]-n.slowDownRatioReverse[e]*n.timeDiff/10),n.speedDecelerationRatioAbs[e]=Math.abs(n.lastFlickSpeed[e]*n.speedDecelerationRatio[e]),n.distanceOffset[e]=n.lastFlickSpeed[e]*n.speedDecelerationRatio[e]*n.timeDiff,me[e]+=n.distanceOffset[e])},panAnimLoop:function(){if(Ve.zoomPan&&(Ve.zoomPan.raf=M(n.panAnimLoop),n.now=Ee(),n.timeDiff=n.now-n.lastNow,n.lastNow=n.now,n.calculateAnimOffset("x"),n.calculateAnimOffset("y"),Oe(),n.calculateOverBoundsAnimOffset("x"),n.calculateOverBoundsAnimOffset("y"),n.speedDecelerationRatioAbs.x<.05&&n.speedDecelerationRatioAbs.y<.05))return me.x=Math.round(me.x),me.y=Math.round(me.y),Oe(),void Qe("zoomPan")}};return n},Wt=function(e){return e.calculateSwipeSpeed("y"),te=o.currItem.bounds,e.backAnimDestination={},e.backAnimStarted={},Math.abs(e.lastFlickSpeed.x)<=.05&&Math.abs(e.lastFlickSpeed.y)<=.05?(e.speedDecelerationRatioAbs.x=e.speedDecelerationRatioAbs.y=0,e.calculateOverBoundsAnimOffset("x"),e.calculateOverBoundsAnimOffset("y"),!0):($e("zoomPan"),e.lastNow=Ee(),void e.panAnimLoop())},Bt=function(e,t){var n;ie||(ft=p);var i;if("swipe"===e){var r=ut.x-ct.x,a=t.lastFlickDist.x<10;r>it&&(a||t.lastFlickOffset.x>20)?i=-1:r<-it&&(a||t.lastFlickOffset.x<-20)&&(i=1)}var u;i&&(p+=i,p<0?(p=l.loop?Qt()-1:0,u=!0):p>=Qt()&&(p=l.loop?0:Qt()-1,u=!0),u&&!l.loop||(xe+=i,he-=i,n=!0));var c,s=ye.x*he,d=Math.abs(s-yt.x);return n||s>yt.x==t.lastFlickSpeed.x>0?(c=Math.abs(t.lastFlickSpeed.x)>0?d/Math.abs(t.lastFlickSpeed.x):333,c=Math.min(c,400),c=Math.max(c,250)):c=333,ft===p&&(n=!1),ie=!0,Se("mainScrollAnimStart"),tt("mainScroll",yt.x,s,c,helper.easing.cubic.out,Fe,function(){et(),ie=!1,ft=-1,(n||ft!==p)&&o.updateCurrItem(),Se("mainScrollAnimComplete")}),n&&o.updateCurrItem(!0),n},Gt=function(e){return 1/ee*e*x},Yt=function(){var e=y,t=We(),n=Be();y<t?e=t:y>n&&(e=n);var i,r=1,a=le;return ae&&!H&&!ue&&y<t?(o.close(),!0):(ae&&(i=function(e){Pe((r-a)*e+a)}),o.zoomTo(e,0,200,helper.easing.cubic.out,i),!0)};Ce("Gestures",{publicMethods:{initGestures:function(){var e=function(e,t,n,i,o){T=e+t,_=e+n,S=e+i,E=o?e+o:""};D=L.pointerEvent,D&&L.touch&&(L.touch=!1),D?navigator.pointerEnabled?e("pointer","down","move","up","cancel"):e("MSPointer","Down","Move","Up","Cancel"):L.touch?(e("touch","start","move","end","cancel"),O=!0):e("mouse","down","move","up"),f=_+" "+S+" "+E,h=T,D&&!O&&(O=navigator.maxTouchPoints>1||navigator.msMaxTouchPoints>1),o.likelyTouchDevice=O,v[T]=Lt,v[_]=Nt,v[S]=Kt,E&&(v[E]=v[S]),L.touch&&(h+=" mousedown",f+=" mousemove mouseup",v.mousedown=v[T],v.mousemove=v[_],v.mouseup=v[S]),O||(l.allowPanToNext=!1)}}});var qt,jt,Xt,Vt,Jt,Qt,$t,en=function(t,n,i,r){qt&&clearTimeout(qt),Vt=!0,Xt=!0;var a;t.initialLayout?(a=t.initialLayout,t.initialLayout=null):a=l.getThumbBoundsFn&&l.getThumbBoundsFn(p);var u=i?l.hideAnimationDuration:l.showAnimationDuration,c=function(){Qe("initialZoom"),i?(o.template.removeAttribute("style"),o.bg.removeAttribute("style")):(Pe(1),n&&(n.style.display="block"),helper.addClass(e,"zvui-pinch__animated-in"),Se("initialZoom"+(i?"OutEnd":"InEnd"))),r&&r(),Vt=!1};if(!u||!a||void 0===a.x)return Se("initialZoom"+(i?"Out":"In")),y=t.initialZoomLevel,Re(me,t.initialPosition),Oe(),e.style.opacity=i?0:1,Pe(1),void(u?setTimeout(function(){c()},u):c());var d=function(){var n=s,r=!o.currItem.src||o.currItem.loadError||l.showHideOpacity;t.miniImg&&(t.miniImg.style.webkitBackfaceVisibility="hidden"),i||(y=a.w/t.w,me.x=a.x,me.y=a.y-A,o[r?"template":"bg"].style.opacity=.001,Oe()),$e("initialZoom"),i&&!n&&helper.removeClass(e,"zvui-pinch__animated-in"),r&&(i?helper[(n?"remove":"add")+"Class"](e,"zvui-pinch__animate_opacity"):setTimeout(function(){helper.addClass(e,"zvui-pinch__animate_opacity")},30)),qt=setTimeout(function(){if(Se("initialZoom"+(i?"Out":"In")),i){var o=a.w/t.w,l={x:me.x,y:me.y},s=y,p=le,d=function(t){1===t?(y=o,me.x=a.x,me.y=a.y-Z):(y=(o-s)*t+s,me.x=(a.x-l.x)*t+l.x,me.y=(a.y-Z-l.y)*t+l.y),Oe(),r?e.style.opacity=1-t:Pe(p-t*p)};n?tt("initialZoom",0,1,u,helper.easing.cubic.out,d,c):(d(1),qt=setTimeout(c,u+20))}else y=t.initialZoomLevel,Re(me,t.initialPosition),Oe(),Pe(1),r?e.style.opacity=1:Pe(1),qt=setTimeout(c,u+20)},i?25:90)};d()},tn={},nn=[],on={index:0,errorMsg:'<div class="zvui-pinch__error-msg"><a href="%url%" target="_blank">The image</a> could not be loaded.</div>',forceProgressiveLoading:!1,preload:[1,1],getNumItemsFn:function(){return jt.length}},rn=function(){return{center:{x:0,y:0},max:{x:0,y:0},min:{x:0,y:0}}},an=function(e,t,n){var i=e.bounds;i.center.x=Math.round((tn.x-t)/2),i.center.y=Math.round((tn.y-n)/2)+e.vGap.top,i.max.x=t>tn.x?Math.round(tn.x-t):i.center.x,i.max.y=n>tn.y?Math.round(tn.y-n)+e.vGap.top:i.center.y,i.min.x=t>tn.x?0:i.center.x,i.min.y=n>tn.y?e.vGap.top:i.center.y},ln=function(e,t,n){if(e.src&&!e.loadError){var i=!n;if(i&&(e.vGap||(e.vGap={top:0,bottom:0}),Se("parseVerticalMargin",e)),tn.x=t.x,tn.y=t.y-e.vGap.top-e.vGap.bottom,i){var o=tn.x/e.w,r=tn.y/e.h;e.fitRatio=o<r?o:r;var a=l.scaleMode;"orig"===a?n=1:"fit"===a&&(n=e.fitRatio),n>1&&(n=1),e.initialZoomLevel=n,e.bounds||(e.bounds=rn())}if(!n)return;return an(e,e.w*n,e.h*n),i&&n===e.initialZoomLevel&&(e.initialPosition=e.bounds.center),e.bounds}return e.w=e.h=0,e.initialZoomLevel=e.fitRatio=1,e.bounds=rn(),e.initialPosition=e.bounds.center,e.bounds},un=function(e,t,n,i,r,a){t.loadError||i&&(t.imageAppended=!0,pn(t,i,t===o.currItem&&ze),n.appendChild(i),a&&setTimeout(function(){t&&t.loaded&&t.placeholder&&(t.placeholder.style.display="none",t.placeholder=null)},500))},cn=function(e){e.loading=!0,e.loaded=!1;var t=e.img=helper.createEl("zvui-pinch__img","img"),n=function(){e.loading=!1,e.loaded=!0,e.loadComplete?e.loadComplete(e):e.img=null,t.onload=t.onerror=null,t=null};return t.onload=n,t.onerror=function(){e.loadError=!0,n()},t.src=e.src,t},sn=function(e,t){if(e.src&&e.loadError&&e.container)return t&&(e.container.innerHTML=""),e.container.innerHTML=l.errorMsg.replace("%url%",e.src),!0},pn=function(e,t,n){if(e.src){t||(t=e.container.lastChild);var i=n?e.w:Math.round(e.w*e.fitRatio),o=n?e.h:Math.round(e.h*e.fitRatio);e.placeholder&&!e.loaded&&(e.placeholder.style.width=i+"px",e.placeholder.style.height=o+"px"),t.style.width=i+"px",t.style.height=o+"px"}},dn=function(){if(nn.length){for(var e,t=0;t<nn.length;t++)e=nn[t],e.holder.index===e.index&&un(e.index,e.item,e.baseDiv,e.img,!1,e.clearPlaceholder);nn=[]}};Ce("Controller",{publicMethods:{lazyLoadItem:function(e){e=Ie(e);var t=Jt(e);t&&(!t.loaded&&!t.loading||z)&&(Se("gettingData",e,t),t.src&&cn(t))},initController:function(){helper.extend(l,on,!0),o.items=jt=n,Jt=o.getItemAt,Qt=l.getNumItemsFn,$t=l.loop,Qt()<3&&(l.loop=!1),_e("beforeChange",function(e){var t,n=l.preload,i=null===e||e>=0,r=Math.min(n[0],Qt()),a=Math.min(n[1],Qt());for(t=1;t<=(i?a:r);t++)o.lazyLoadItem(p+t);for(t=1;t<=(i?r:a);t++)o.lazyLoadItem(p-t)}),_e("initialLayout",function(){o.currItem.initialLayout=l.getThumbBoundsFn&&l.getThumbBoundsFn(p)}),_e("mainScrollAnimComplete",dn),_e("initialZoomInEnd",dn),_e("destroy",function(){for(var e,t=0;t<jt.length;t++)e=jt[t],e.container&&(e.container=null),e.placeholder&&(e.placeholder=null),e.img&&(e.img=null),e.preloader&&(e.preloader=null),e.loadError&&(e.loaded=e.loadError=!1);nn=null})},getItemAt:function(e){return e>=0&&(void 0!==jt[e]&&jt[e])},allowProgressiveImg:function(){return l.forceProgressiveLoading||!O||l.mouseUsed||screen.width>1200},setContent:function(e,t){l.loop&&(t=Ie(t));var n=o.getItemAt(e.index);n&&(n.container=null);var i,r=o.getItemAt(t);if(!r)return void(e.el.innerHTML="");Se("gettingData",t,r),e.index=t,e.item=r;var a=r.container=helper.createEl("zvui-pinch__zoom-wrap");if(!r.src&&r.html&&(r.html.tagName?a.appendChild(r.html):a.innerHTML=r.html),sn(r),ln(r,fe),!r.src||r.loadError||r.loaded)r.src&&!r.loadError&&(i=helper.createEl("zvui-pinch__img","img"),i.style.opacity=1,i.src=r.src,pn(r,i),un(t,r,a,i,!0));else{if(r.loadComplete=function(n){if(u){if(e&&e.index===t){if(sn(n,!0))return n.loadComplete=n.img=null,ln(n,fe),Me(n),void(e.index===p&&o.updateCurrZoomItem());n.imageAppended?!Vt&&n.placeholder&&(n.placeholder.style.display="none",n.placeholder=null):L.transform&&(ie||Vt)?nn.push({item:n,baseDiv:a,img:n.img,index:t,holder:e,clearPlaceholder:!0}):un(t,n,a,n.img,ie||Vt,!0)}n.loadComplete=null,n.img=null,Se("imageLoadComplete",t,n)}},helper.features.transform){var c="zvui-pinch__img zvui-pinch__img--placeholder";c+=r.msrc?"":" zvui-pinch__img--placeholder--blank";var s=helper.createEl(c,r.msrc?"img":"");r.msrc&&(s.src=r.msrc),pn(r,s),a.appendChild(s),r.placeholder=s}r.loading||cn(r),o.allowProgressiveImg()&&(!Xt&&L.transform?nn.push({item:r,baseDiv:a,img:r.img,index:t,holder:e}):un(t,r,a,r.img,!0,!0))}Xt||t!==p?Me(r):(ne=a.style,en(r,i||r.img)),e.el.innerHTML="",e.el.appendChild(a)},cleanSlide:function(e){e.img&&(e.img.onload=e.img.onerror=null),e.loaded=e.loading=e.img=e.imageAppended=!1}}});var mn,fn={},hn=function(e,t,n){var i=document.createEvent("CustomEvent"),o={origEvent:e,target:e.target,releasePoint:t,pointerType:n||"touch"};i.initCustomEvent("zvuiPinchTap",!0,!0,o),e.target.dispatchEvent(i)};Ce("Tap",{publicMethods:{initTap:function(){_e("firstTouchStart",o.onTapStart),_e("touchRelease",o.onTapRelease),_e("destroy",function(){fn={},mn=null})},onTapStart:function(e){e.length>1&&(clearTimeout(mn),mn=null)},onTapRelease:function(e,t){if(t&&!j&&!Y&&!Je){var n=t;if(mn&&(clearTimeout(mn),mn=null,wt(n,fn)))return void Se("doubleTap",n);if("mouse"===t.type)return void hn(e,t,"mouse");var i=e.target.tagName.toUpperCase();if("BUTTON"===i||helper.hasClass(e.target,"zvui-pinch__single-tap"))return void hn(e,t);Re(fn,n),mn=setTimeout(function(){hn(e,t),mn=null},300)}}}});var vn;Ce("DesktopZoom",{publicMethods:{initDesktopZoom:function(){R||(O?_e("mouseUsed",function(){o.setupDesktopZoom()}):o.setupDesktopZoom(!0))},setupDesktopZoom:function(t){vn={};var n="wheel mousewheel DOMMouseScroll";_e("bindEvents",function(){helper.bind(e,n,o.handleMouseWheel)}),_e("unbindEvents",function(){vn&&helper.unbind(e,n,o.handleMouseWheel)}),o.mouseZoomedIn=!1;var i,r=function(){o.mouseZoomedIn&&(helper.removeClass(e,"zvui-pinch--zoomed-in"),o.mouseZoomedIn=!1),y<1?helper.addClass(e,"zvui-pinch--zoom-allowed"):helper.removeClass(e,"zvui-pinch--zoom-allowed"),a()},a=function(){i&&(helper.removeClass(e,"zvui-pinch--dragging"),i=!1)};_e("resize",r),_e("afterChange",r),_e("pointerDown",function(){o.mouseZoomedIn&&(i=!0,helper.addClass(e,"zvui-pinch--dragging"))}),_e("pointerUp",a),t||r()},handleMouseWheel:function(e){if(y<=o.currItem.fitRatio)return l.modal&&(!l.closeOnScroll||Je||G?e.preventDefault():P&&Math.abs(e.deltaY)>2&&(s=!0,
o.close())),!0;if(e.stopPropagation(),vn.x=0,"deltaX"in e)1===e.deltaMode?(vn.x=18*e.deltaX,vn.y=18*e.deltaY):(vn.x=e.deltaX,vn.y=e.deltaY);else if("wheelDelta"in e)e.wheelDeltaX&&(vn.x=-.16*e.wheelDeltaX),e.wheelDeltaY?vn.y=-.16*e.wheelDeltaY:vn.y=-.16*e.wheelDelta;else{if(!("detail"in e))return;vn.y=e.detail}He(y,!0);var t=me.x-vn.x,n=me.y-vn.y;(l.modal||t<=te.min.x&&t>=te.max.x&&n<=te.min.y&&n>=te.max.y)&&e.preventDefault(),o.panTo(t,n)},toggleDesktopZoom:function(t){t=t||{x:fe.x/2+ve.x,y:fe.y/2+ve.y};var n=l.getDoubleTapZoom(!0,o.currItem),i=y===n;o.mouseZoomedIn=!i,o.zoomTo(i?o.currItem.initialZoomLevel:n,t,333),helper[(i?"remove":"add")+"Class"](e,"zvui-pinch--zoomed-in")}}});var yn,xn,gn,bn,wn,zn,Cn,In,Tn,_n,Sn,En,Pn={history:!0,galleryUID:1},Dn=function(){return Sn.hash.substring(1)},On=function(){yn&&clearTimeout(yn),gn&&clearTimeout(gn)},Mn=function(){var e=Dn(),t={};if(e.length<5)return t;var n,i=e.split("&");for(n=0;n<i.length;n++)if(i[n]){var o=i[n].split("=");o.length<2||(t[o[0]]=o[1])}if(l.galleryPIDs){var r=t.pid;for(t.pid=0,n=0;n<jt.length;n++)if(jt[n].pid===r){t.pid=n;break}}else t.pid=parseInt(t.pid,10)-1;return t.pid<0&&(t.pid=0),t},kn=function Zn(){if(gn&&clearTimeout(gn),Je||G)return void(gn=setTimeout(Zn,500));bn?clearTimeout(xn):bn=!0;var e=p+1,t=Jt(p);t.hasOwnProperty("pid")&&(e=t.pid);var n=Cn+"&gid="+l.galleryUID+"&pid="+e;In||Sn.hash.indexOf(n)===-1&&(_n=!0);var i=Sn.href.split("#")[0]+"#"+n;En?"#"+n!==window.location.hash&&history[In?"replaceState":"pushState"]("",document.title,i):In?Sn.replace(i):Sn.hash=n,In=!0,xn=setTimeout(function(){bn=!1},60)};Ce("History",{publicMethods:{initHistory:function(){if(helper.extend(l,Pn,!0),l.history){Sn=window.location,_n=!1,Tn=!1,In=!1,Cn=Dn(),En="pushState"in history,Cn.indexOf("gid=")>-1&&(Cn=Cn.split("&gid=")[0],Cn=Cn.split("?gid=")[0]),_e("afterChange",o.updateURL),_e("unbindEvents",function(){helper.unbind(window,"hashchange",o.onHashChange)});var e=function(){zn=!0,Tn||(_n?history.back():Cn?Sn.hash=Cn:En?history.pushState("",document.title,Sn.pathname+Sn.search):Sn.hash=""),On()};_e("unbindEvents",function(){s&&e()}),_e("destroy",function(){zn||e()}),_e("firstUpdate",function(){p=Mn().pid});var t=Cn.indexOf("pid=");t>-1&&(Cn=Cn.substring(0,t),"&"===Cn.slice(-1)&&(Cn=Cn.slice(0,-1))),setTimeout(function(){u&&helper.bind(window,"hashchange",o.onHashChange)},40)}},onHashChange:function(){return Dn()===Cn?(Tn=!0,void o.close()):void(bn||(wn=!0,o.goTo(Mn().pid),wn=!1))},updateURL:function(){On(),wn||(In?yn=setTimeout(kn,800):kn())}}}),helper.extend(o,nt)}})},function(e,t,n){var i,o;"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(r,a){i=a,o="function"==typeof i?i.call(t,n,t,e):i,!(void 0!==o&&(e.exports=o))}(void 0,function(e,t,n){return function(e,t){var n,i,o,r,a,l,u,c,s,p,d,m,f,h,v,y,x,g,b,w=this,z=!1,C=!0,I=!1,T={barsSize:{top:44,bottom:"auto"},closeElClasses:["item","caption","zoom-wrap","ui","top-bar"],timeToIdle:4e3,timeToIdleOutside:1e3,loadingIndicatorDelay:1e3,addCaptionHTMLFn:function(e,t){return e.title?(t.children[0].innerHTML=e.title,!0):(t.children[0].innerHTML="",!1)},closeEl:!0,captionEl:!0,fullscreenEl:!0,zoomEl:!0,shareEl:!1,counterEl:!0,arrowEl:!0,preloaderEl:!0,tapToClose:!1,tapToToggleControls:!0,clickToCloseNonZoomable:!0,shareButtons:[{id:"facebook",label:"Share on Facebook",url:"https://www.facebook.com/sharer/sharer.php?u={{url}}"},{id:"twitter",label:"Tweet",url:"https://twitter.com/intent/tweet?text={{text}}&url={{url}}"},{id:"pinterest",label:"Pin it",url:"http://www.pinterest.com/pin/create/button/?url={{url}}&media={{image_url}}&description={{text}}"},{id:"download",label:"Download image",url:"{{raw_image_url}}",download:!0}],getImageURLForShare:function(){return zvuiPinch.currItem.src||""},getPageURLForShare:function(){return window.location.href},getTextForShare:function(){return zvuiPinch.currItem.title||""},indexIndicatorSep:" / ",fitControlsWidth:1200},_=function(e){if(y)return!0;e=e||window.event,v.timeToIdle&&v.mouseUsed&&!s&&R();for(var t,n,i=e.target||e.srcElement,o=i.getAttribute("class")||"",r=0;r<B.length;r++)t=B[r],t.onTap&&o.indexOf("zvui-pinch_"+t.name)>-1&&(t.onTap(),n=!0);if(n){e.stopPropagation&&e.stopPropagation(),y=!0;var a=helper.features.isOldAndroid?600:30;x=setTimeout(function(){y=!1},a)}},S=function(){return!zvuiPinch.likelyTouchDevice||v.mouseUsed||screen.width>v.fitControlsWidth},E=function(e,t,n){helper[(n?"add":"remove")+"Class"](e,"zvui-pinch_"+t)},P=function(){var e=1===v.getNumItemsFn();e!==h&&(E(i,"ui--one-slide",e),h=e)},D=function(){E(u,"share-modal--hidden",I)},O=function(){return I=!I,I?(helper.removeClass(u,"zvui-pinch_share-modal--fade-in"),setTimeout(function(){I&&D()},300)):(D(),setTimeout(function(){I||helper.addClass(u,"zvui-pinch_share-modal--fade-in")},30)),I||k(),!1},M=function(e){e=e||window.event;var t=e.target||e.srcElement;return zvuiPinch.shout("shareLinkClick",e,t),!!t.href&&(!!t.hasAttribute("download")||(window.open(t.href,"zvui-pinchshare","scrollbars=yes,resizable=yes,toolbar=no,location=yes,width=550,height=420,top=100,left="+(window.screen?Math.round(screen.width/2-275):100)),I||O(),!1))},k=function(){for(var e,t,n,i,o,r="",a=0;a<v.shareButtons.length;a++)e=v.shareButtons[a],n=v.getImageURLForShare(e),i=v.getPageURLForShare(e),o=v.getTextForShare(e),t=e.url.replace("{{url}}",encodeURIComponent(i)).replace("{{image_url}}",encodeURIComponent(n)).replace("{{raw_image_url}}",n).replace("{{text}}",encodeURIComponent(o)),r+='<a href="'+t+'" target="_blank" class="zvui-pinch_share--'+e.id+'"'+(e.download?"download":"")+">"+e.label+"</a>",v.parseShareButtonOut&&(r=v.parseShareButtonOut(e,r));u.children[0].innerHTML=r,u.children[0].onclick=M},F=function(e){for(var t=0;t<v.closeElClasses.length;t++)if(helper.hasClass(e,"zvui-pinch_"+v.closeElClasses[t]))return!0},A=0,R=function(){clearTimeout(b),A=0,s&&w.setIdle(!1)},Z=function(e){e=e?e:window.event;var t=e.relatedTarget||e.toElement;t&&"HTML"!==t.nodeName||(clearTimeout(b),b=setTimeout(function(){w.setIdle(!0)},v.timeToIdleOutside))},L=function(){v.fullscreenEl&&!helper.features.isOldAndroid&&(n||(n=w.getFullscreenAPI()),n?(helper.bind(document,n.eventK,w.updateFullscreen),w.updateFullscreen(),helper.addClass(zvuiPinch.template,"zvui-pinch--supports-fs")):helper.removeClass(zvuiPinch.template,"zvui-pinch--supports-fs"))},N=function(){v.preloaderEl&&(U(!0),p("beforeChange",function(){clearTimeout(f),f=setTimeout(function(){zvuiPinch.currItem&&zvuiPinch.currItem.loading?(!zvuiPinch.allowProgressiveImg()||zvuiPinch.currItem.img&&!zvuiPinch.currItem.img.naturalWidth)&&U(!1):U(!0)},v.loadingIndicatorDelay)}),p("imageLoadComplete",function(e,t){zvuiPinch.currItem===t&&U(!0)}))},U=function(e){m!==e&&(E(d,"preloader--active",!e),m=e)},K=function(e){var t=e.vGap;if(S()){var n=v.barsSize;if(v.captionEl&&"auto"===n.bottom)if(r||(r=helper.createEl("zvui-pinch_caption zvui-pinch_caption--fake"),r.appendChild(helper.createEl("zvui-pinch_caption__center")),i.insertBefore(r,o),helper.addClass(i,"zvui-pinch_ui--fit")),v.addCaptionHTMLFn(e,r,!0)){var a=r.clientHeight;t.bottom=parseInt(a,10)||44}else t.bottom=n.top;else t.bottom="auto"===n.bottom?0:n.bottom;t.top=n.top}else t.top=t.bottom=0},H=function(){v.timeToIdle&&p("mouseUsed",function(){helper.bind(document,"mousemove",R),helper.bind(document,"mouseout",Z),g=setInterval(function(){A++,2===A&&w.setIdle(!0)},v.timeToIdle/2)})},W=function(){p("onVerticalDrag",function(e){C&&e<.95?w.hideControls():!C&&e>=.95&&w.showControls()});var e;p("onPinchClose",function(t){C&&t<.9?(w.hideControls(),e=!0):e&&!C&&t>.9&&w.showControls()}),p("zoomGestureEnded",function(){e=!1,e&&!C&&w.showControls()})},B=[{name:"caption",option:"captionEl",onInit:function(e){o=e}},{name:"share-modal",option:"shareEl",onInit:function(e){u=e},onTap:function(){O()}},{name:"button--share",option:"shareEl",onInit:function(e){l=e},onTap:function(){O()}},{name:"button--zoom",option:"zoomEl",onTap:zvuiPinch.toggleDesktopZoom},{name:"counter",option:"counterEl",onInit:function(e){a=e}},{name:"button--close",option:"closeEl",onTap:zvuiPinch.close},{name:"button--arrow--left",option:"arrowEl",onTap:zvuiPinch.prev},{name:"button--arrow--right",option:"arrowEl",onTap:zvuiPinch.next},{name:"button--fs",option:"fullscreenEl",onTap:function(){n.isFullscreen()?n.exit():n.enter()}},{name:"preloader",option:"preloaderEl",onInit:function(e){d=e}}],G=function(){var e,t,n,o=function(i){if(i)for(var o=i.length,r=0;r<o;r++){e=i[r],t=e.className;for(var a=0;a<B.length;a++)n=B[a],t.indexOf("zvui-pinch_"+n.name)>-1&&(v[n.option]?(helper.removeClass(e,"zvui-pinch_element--disabled"),n.onInit&&n.onInit(e)):helper.addClass(e,"zvui-pinch_element--disabled"))}};o(i.children);var r=helper.getChildByClass(i,"zvui-pinch_top-bar");r&&o(r.children)};w.init=function(){helper.extend(zvuiPinch.options,T,!0),v=zvuiPinch.options,i=helper.getChildByClass(zvuiPinch.scrollWrap,"zvui-pinch_ui"),p=zvuiPinch.listen,W(),p("beforeChange",w.update),p("doubleTap",function(e){var t=zvuiPinch.currItem.initialZoomLevel;zvuiPinch.getZoomLevel()!==t?zvuiPinch.zoomTo(t,e,333):zvuiPinch.zoomTo(v.getDoubleTapZoom(!1,zvuiPinch.currItem),e,333)}),p("preventDragEvent",function(e,t,n){var i=e.target||e.srcElement;i&&i.getAttribute("class")&&e.type.indexOf("mouse")>-1&&(i.getAttribute("class").indexOf("__caption")>0||/(SMALL|STRONG|EM)/i.test(i.tagName))&&(n.prevent=!1)}),p("bindEvents",function(){helper.bind(i,"zvuiTap click",_),helper.bind(zvuiPinch.scrollWrap,"zvuiTap",w.onGlobalTap),zvuiPinch.likelyTouchDevice||helper.bind(zvuiPinch.scrollWrap,"mouseover",w.onMouseOver)}),p("unbindEvents",function(){I||O(),g&&clearInterval(g),helper.unbind(document,"mouseout",Z),helper.unbind(document,"mousemove",R),helper.unbind(i,"zvuiTap click",_),helper.unbind(zvuiPinch.scrollWrap,"zvuiTap",w.onGlobalTap),helper.unbind(zvuiPinch.scrollWrap,"mouseover",w.onMouseOver),n&&(helper.unbind(document,n.eventK,w.updateFullscreen),n.isFullscreen()&&(v.hideAnimationDuration=0,n.exit()),n=null)}),p("destroy",function(){v.captionEl&&(r&&i.removeChild(r),helper.removeClass(o,"zvui-pinch_caption--empty")),u&&(u.children[0].onclick=null),helper.removeClass(i,"zvui-pinch_ui--over-close"),helper.addClass(i,"zvui-pinch_ui--hidden"),w.setIdle(!1)}),v.showAnimationDuration||helper.removeClass(i,"zvui-pinch_ui--hidden"),p("initialZoomIn",function(){v.showAnimationDuration&&helper.removeClass(i,"zvui-pinch_ui--hidden")}),p("initialZoomOut",function(){helper.addClass(i,"zvui-pinch_ui--hidden")}),p("parseVerticalMargin",K),G(),v.shareEl&&l&&u&&(I=!0),P(),H(),L(),N()},w.setIdle=function(e){s=e,E(i,"ui--idle",e)},w.update=function(){C&&zvuiPinch.currItem?(w.updateIndexIndicator(),v.captionEl&&(v.addCaptionHTMLFn(zvuiPinch.currItem,o),E(o,"caption--empty",!zvuiPinch.currItem.title)),z=!0):z=!1,I||O(),P()},w.updateFullscreen=function(e){e&&setTimeout(function(){zvuiPinch.setScrollOffset(0,helper.getScrollY())},50),helper[(n.isFullscreen()?"add":"remove")+"Class"](zvuiPinch.template,"zvui-pinch--fs")},w.updateIndexIndicator=function(){v.counterEl&&(a.innerHTML=zvuiPinch.getCurrentIndex()+1+v.indexIndicatorSep+v.getNumItemsFn())},w.onGlobalTap=function(e){e=e||window.event;var t=e.target||e.srcElement;if(!y)if(e.detail&&"mouse"===e.detail.pointerType){if(F(t))return void zvuiPinch.close();helper.hasClass(t,"zvui-pinch_img")&&(1===zvuiPinch.getZoomLevel()&&zvuiPinch.getZoomLevel()<=zvuiPinch.currItem.fitRatio?v.clickToCloseNonZoomable&&zvuiPinch.close():zvuiPinch.toggleDesktopZoom(e.detail.releasePoint))}else if(v.tapToToggleControls&&(C?w.hideControls():w.showControls()),v.tapToClose&&(helper.hasClass(t,"zvui-pinch_img")||F(t)))return void zvuiPinch.close()},w.onMouseOver=function(e){e=e||window.event;var t=e.target||e.srcElement;E(i,"ui--over-close",F(t))},w.hideControls=function(){helper.addClass(i,"zvui-pinch_ui--hidden"),C=!1},w.showControls=function(){C=!0,z||w.update(),helper.removeClass(i,"zvui-pinch_ui--hidden")},w.supportsFullscreen=function(){var e=document;return!!(e.exitFullscreen||e.mozCancelFullScreen||e.webkitExitFullscreen||e.msExitFullscreen)},w.getFullscreenAPI=function(){var e,t=document.documentElement,n="fullscreenchange";return t.requestFullscreen?e={enterK:"requestFullscreen",exitK:"exitFullscreen",elementK:"fullscreenElement",eventK:n}:t.mozRequestFullScreen?e={enterK:"mozRequestFullScreen",exitK:"mozCancelFullScreen",elementK:"mozFullScreenElement",eventK:"moz"+n}:t.webkitRequestFullscreen?e={enterK:"webkitRequestFullscreen",exitK:"webkitExitFullscreen",elementK:"webkitFullscreenElement",eventK:"webkit"+n}:t.msRequestFullscreen&&(e={enterK:"msRequestFullscreen",exitK:"msExitFullscreen",elementK:"msFullscreenElement",eventK:"MSFullscreenChange"}),e&&(e.enter=function(){return c=v.closeOnScroll,v.closeOnScroll=!1,"webkitRequestFullscreen"!==this.enterK?zvuiPinch.template[this.enterK]():void zvuiPinch.template[this.enterK](Element.ALLOW_KEYBOARD_INPUT)},e.exit=function(){return v.closeOnScroll=c,document[this.exitK]()},e.isFullscreen=function(){return document[this.elementK]}),e}}})},function(e,t,n){var i,o;!function(){"use strict";function n(){for(var e=[],t=0;t<arguments.length;t++){var i=arguments[t];if(i){var o=typeof i;if("string"===o||"number"===o)e.push(i);else if(Array.isArray(i))e.push(n.apply(null,i));else if("object"===o)for(var a in i)r.call(i,a)&&i[a]&&e.push(a)}}return e.join(" ")}var r={}.hasOwnProperty;"undefined"!=typeof e&&e.exports?e.exports=n:(i=[],o=function(){return n}.apply(t,i),!(void 0!==o&&(e.exports=o)))}()},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=["beforeChange","afterChange","imageLoadComplete","resize","initialZoomIn","initialZoomInEnd","initialZoomOut","initialZoomOutEnd","close","unbindEvents","destroy","updateScrollOffset","preventDragEvent"]},function(e,t){}])});